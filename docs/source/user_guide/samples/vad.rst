Детектирование речевой активности в аудиовизуальном сигнале
===========================================================
.. |br| raw:: html

   </br>

.. |b| raw:: html

   <b>

.. |/b| raw:: html

   </b>

.. toctree::
   :maxdepth: 1
   :caption: Содержание:


Команда для запуска детектирования речевой активности в аудиовизуальном сигнале:

.. code-block:: sh

   python ./openav/api/vad.py --config <путь_к_вашему_конфигурационному_файлу>.json

.. Пример на наш конфиг... доделать.

.. important:: Для запуска команды необходимо обязательно указать путь к конфигурационному файлу. Запускать программу необходимо из директории, где она расположена.

Конфигурационный файл
---------------------

Конфигурационный файл включает в себя следующие настройки:

*  Отображение процесса выполнения программы в терминале (командной строке)
*  Работа с файловой системой
*  Параметры детектора голосовой активности (VAD)
*  Параметры кодировки выходного файла

Отображение процесса выполнения команды в терминале
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. rst-class:: custom-table shell-table
.. csv-table::
   :align: center
   :header: "Параметр", "Тип", "Значение по умолчанию", "Описание"
   :widths: 23, 7, 25, 45

    "hide_metadata", "bool", "``false``", "Включение отображения метаданных"
    "hide_libs_vers", "bool", "``false``", "Включение отображения версий установленных  библиотек  в командной строке"


Работа с файловой системой
~~~~~~~~~~~~~~~~~~~~~~~~~~

.. rst-class:: custom-table filesystem-table
.. csv-table::
   :align: center
   :header: "Параметр", "Тип", "Значение по умолчанию", "Описание"
   :widths: 23, 7, 25, 45

    "path_to_save_model", "str", "``<./models>``", "Директория, где будут размещаться скачанные модели, в данном случае модель для работоспособности  VAD"
    "path_to_dataset", "str", "``<путь_к_исходным_данным>``", "Директория, где находятся данные, которые необходимо обработать VAD"
    "path_to_dataset_vad", "str", "``<./dataset_vad>``", "Директория, куда сохраняются фрагменты аудиовизуального сигнала после обработки VAD"
    "dir_va_names", "dict", "``{""video"": ""Video"",`` |br| ``""audio"": ""Audio""}``", "Директории для сохранения видео и аудио файлов. Названия директорий могут быть произвольными"
    "force_reload", "bool", "``false``", "Включение принудительной загрузки модели VAD из сети"
    "clear_dirvad", "bool", "``true``", "Очистка директории, в которую сохраняются фрагменты аудиовизуального сигнала"
    "depth","int", "``1``", "Глубина иерархии для получения данных. Указывается количество подкаталогов  в директории ``path_to_dataset``"
    "ext_search_files", "list", "``[""mov"", ""mp4"", ""wav""]``", "Список  расширений файлов, которые будут обрабатываться. Указывать  можно как для видео, так и для аудио."


Параметры детектора голосовой активности (VAD)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. rst-class:: custom-table vad-table
.. csv-table::
   :align: center
   :header: "Параметр", "Тип", "Значение по умолчанию", "Описание"
   :widths: 28, 7, 20, 45

   "sampling_rate", "int", "``16000``", "Частота дискретизации. На текущий момент поддерживаются частоты: ``8000`` и ``16000``"
   "threshold", "float", "``0.5``", "Порог речи. VAD выводит вероятности речи для каждого звукового фрагмента, вероятности выше установеленного значения считаются РЕЧЬЮ. Параметр необходимо настраивать индивидуально в зависимости от набора данных. Например для шумных условий параметр рекомендуется устанавливать в значение от ``0.7`` до ``0.95``. В условиях низкого уровня шума или его отсутствия, параметр лучше устанавливать на низкие значения ``0.1`` — ``0.25``"
   "min_speech_duration_ms", "float", "``250``", "Отбрасывать финальные фрагменты речи, которые короче установленного значения. Рекомендуется устанавливать в пределах от ``750`` мс до ``1000`` мс. Настройка также является индвидуальной, которую необходимо подбирать в зависимости от набора данных"
   "min_silence_duration_ms", "float", "``100``", "Время ожидания после каждого фрагмента речи, прежде чем разделить его. Рекомендуется устанавливать в пределах ``500`` мс, для того, чтобы не разделялись предложения. Однако, можно настроить индивидуально, под свои условия"
   "window_size_samples", "int", "``1536``", "Размер выборки аудиофрагмента, которая подается на модель VAD. |br| |b| Предупреждение! |/b| Модели VAD были обучены с использованием выборок ``512``, ``1024``, ``1536`` для частоты дискретизации ``16000`` и ``256``, ``512``, ``768`` для частоты дискретизации ``8000``. Настоятельно рекомендуется использовать эти значения, изменение значений может повлиять на производительность модели"
   "speech_pad_ms", "float", "``30``", "Добавление установленного значения в мс с каждой стороны обнаруженного фрагмента речи. Рекомендуется использовать значение ``250`` мс — ``400`` мс чтобы избежать обрезания фрагментов речи. Настройка также является индвидуальная и устанавливается в соответствии с условиями пользователя"
